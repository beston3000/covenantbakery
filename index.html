<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Covenant Hills Bakery</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <script src="https://js.stripe.com/v3/"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 0;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .logo {
            font-size: 28px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .nav-links {
            display: flex;
            gap: 30px;
            align-items: center;
        }
        
        .nav-link {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            padding: 8px 16px;
            border-radius: 25px;
            cursor: pointer;
        }
        
        .nav-link:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }
        
        .btn-secondary:hover {
            background: #667eea;
            color: white;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }
        
        .menu-item {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .menu-item:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }
        
        .menu-item-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            color: #fff;
            position: relative;
            overflow: hidden;
        }
        
        .menu-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .menu-item-content {
            padding: 20px;
        }
        
        .menu-item-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }
        
        .menu-item-description {
            color: #666;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .menu-item-price {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }
        
        .cart-item:last-child {
            border-bottom: none;
        }
        
        .location-banner {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            padding: 15px;
            text-align: center;
            margin-bottom: 20px;
            border-radius: 10px;
            font-weight: 600;
        }
        
        .loading-banner {
            background: linear-gradient(135deg, #feca57 0%, #ff9ff3 100%);
            color: white;
            padding: 15px;
            text-align: center;
            margin-bottom: 20px;
            border-radius: 10px;
            font-weight: 600;
        }
        
        .admin-banner {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 15px;
            text-align: center;
            margin-bottom: 20px;
            border-radius: 10px;
            font-weight: 600;
        }
        
        .admin-panel {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-top: 20px;
        }
        
        .admin-section {
            margin-bottom: 40px;
        }
        
        .admin-section h3 {
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }
        
        .orders-list {
            background: white;
            border-radius: 10px;
            padding: 20px;
        }
        
        .order-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            margin-bottom: 15px;
        }
        
        .order-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-completed {
            background: #d1edff;
            color: #0c5460;
        }
        
        .google-btn {
            background: #4285f4;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            width: 100%;
            justify-content: center;
        }
        
        .google-btn:hover {
            background: #3367d6;
        }
        
        .divider {
            text-align: center;
            margin: 20px 0;
            position: relative;
        }
        
        .divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: #ddd;
        }
        
        .divider span {
            background: white;
            padding: 0 15px;
            color: #666;
        }
        
        .firebase-config-notice {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .firebase-config-notice h4 {
            margin-bottom: 10px;
        }
        
        .firebase-config-notice code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
        
        @media (max-width: 768px) {
            .nav {
                flex-direction: column;
                gap: 20px;
            }
            
            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .menu-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Firebase Configuration - Replace with your actual config
        const firebaseConfig = {
			apiKey: "AIzaSyCwgwgWwD_NLVQtvvQxb-vIwkvbfmG6imc",
			authDomain: "bakery-f6650.firebaseapp.com",
			projectId: "bakery-f6650",
			messagingSenderId: "300373370370",
			appId: "1:300373370370:web:55ff7da416898ed065e91b",
		};

        // Initialize Firebase
        let app, auth, db;
        let isFirebaseConfigured = false;

        try {
            // Check if Firebase config is properly set
            if (firebaseConfig.apiKey !== "your-api-key-here") {
                app = firebase.initializeApp(firebaseConfig);
                auth = firebase.auth();
                db = firebase.firestore();
                isFirebaseConfigured = true;
                
                // Enable offline persistence
                db.enablePersistence().catch((err) => {
                    console.log("Firestore persistence error:", err);
                });
            }
        } catch (error) {
            console.error("Firebase initialization error:", error);
        }

        // Firebase Service Layer
        const FirebaseService = {
            // Authentication
            auth: {
                signUp: async (email, password, displayName) => {
                    if (!isFirebaseConfigured) throw new Error("Firebase not configured");
                    
                    const result = await auth.createUserWithEmailAndPassword(email, password);
                    await result.user.updateProfile({ displayName });
                    
                    // Create user document
                    await db.collection('users').doc(result.user.uid).set({
                        email,
                        displayName,
                        role: 'customer',
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    return result.user;
                },
                
                signIn: async (email, password) => {
                    if (!isFirebaseConfigured) throw new Error("Firebase not configured");
                    const result = await auth.signInWithEmailAndPassword(email, password);
                    return result.user;
                },
                
                signInWithGoogle: async () => {
                    if (!isFirebaseConfigured) throw new Error("Firebase not configured");
                    const provider = new firebase.auth.GoogleAuthProvider();
                    const result = await auth.signInWithPopup(provider);
                    
                    // Check if user document exists, create if not
                    const userDoc = await db.collection('users').doc(result.user.uid).get();
                    if (!userDoc.exists) {
                        await db.collection('users').doc(result.user.uid).set({
                            email: result.user.email,
                            displayName: result.user.displayName,
                            role: 'customer',
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        });
                    }
                    
                    return result.user;
                },
                
                signOut: async () => {
                    if (!isFirebaseConfigured) throw new Error("Firebase not configured");
                    await auth.signOut();
                },
                
                onAuthStateChanged: (callback) => {
                    if (!isFirebaseConfigured) return () => {};
                    return auth.onAuthStateChanged(callback);
                },
                
                getCurrentUser: () => {
                    if (!isFirebaseConfigured) return null;
                    return auth.currentUser;
                }
            },
            
            // User management
            users: {
                getUserData: async (uid) => {
                    if (!isFirebaseConfigured) throw new Error("Firebase not configured");
                    const doc = await db.collection('users').doc(uid).get();
                    return doc.exists ? { id: doc.id, ...doc.data() } : null;
                },
                
                updateUserRole: async (uid, role) => {
                    if (!isFirebaseConfigured) throw new Error("Firebase not configured");
                    await db.collection('users').doc(uid).update({ role });
                }
            },
            
            // Menu items
            menu: {
                getItems: () => {
                    if (!isFirebaseConfigured) throw new Error("Firebase not configured");
                    return db.collection('menuItems').orderBy('createdAt', 'desc');
                },
                
                addItem: async (item) => {
                    if (!isFirebaseConfigured) throw new Error("Firebase not configured");
                    await db.collection('menuItems').add({
                        ...item,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                },
                
                updateItem: async (id, updates) => {
                    if (!isFirebaseConfigured) throw new Error("Firebase not configured");
                    await db.collection('menuItems').doc(id).update({
                        ...updates,
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                },
                
                deleteItem: async (id) => {
                    if (!isFirebaseConfigured) throw new Error("Firebase not configured");
                    await db.collection('menuItems').doc(id).delete();
                }
            },
            
            // Orders
            orders: {
                getOrders: () => {
                    if (!isFirebaseConfigured) throw new Error("Firebase not configured");
                    return db.collection('orders').orderBy('createdAt', 'desc');
                },
                
                addOrder: async (order) => {
                    if (!isFirebaseConfigured) throw new Error("Firebase not configured");
                    await db.collection('orders').add({
                        ...order,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                },
                
                updateOrderStatus: async (id, status) => {
                    if (!isFirebaseConfigured) throw new Error("Firebase not configured");
                    await db.collection('orders').doc(id).update({
                        status,
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                }
            }
        };

        // Mock data for when Firebase is not configured
        const MOCK_MENU_ITEMS = [
            {
                id: '1',
                name: "Classic Chocolate Cupcake",
                description: "Rich chocolate cupcake with vanilla buttercream frosting",
                price: 4.50,
                category: "cupcakes",
                inStock: true,
                image: "ðŸ§",
                imageUrl: null
            },
            {
                id: '2',
                name: "Red Velvet Cake Slice",
                description: "Moist red velvet cake with cream cheese frosting",
                price: 6.75,
                category: "cakes",
                inStock: true,
                image: "ðŸ°",
                imageUrl: null
            },
            {
                id: '3',
                name: "Fresh Strawberry Tart",
                description: "Buttery tart shell filled with pastry cream and fresh strawberries",
                price: 5.25,
                category: "tarts",
                inStock: false,
                image: "ðŸ¥§",
                imageUrl: null
            },
            {
                id: '4',
                name: "Artisan Sourdough Bread",
                description: "Traditional sourdough bread baked fresh daily",
                price: 8.00,
                category: "bread",
                inStock: true,
                image: "ðŸž",
                imageUrl: null
            },
            {
                id: '5',
                name: "Blueberry Muffin",
                description: "Fluffy muffin bursting with fresh blueberries",
                price: 3.25,
                category: "muffins",
                inStock: true,
                image: "ðŸ§",
                imageUrl: null
            },
            {
                id: '6',
                name: "Lemon Meringue Pie",
                description: "Tangy lemon filling topped with fluffy meringue",
                price: 18.00,
                category: "pies",
                inStock: true,
                image: "ðŸ¥§",
                imageUrl: null
            }
        ];

        // Location service
        const LocationService = {
            checkLocation: () => {
                return new Promise((resolve, reject) => {
                    if (!navigator.geolocation) {
                        reject(new Error('Geolocation not supported'));
                        return;
                    }

                    navigator.geolocation.getCurrentPosition(
                        (position) => {
                            const { latitude, longitude } = position.coords;
                            // Covenant Hills, Ladera Ranch approximate coordinates
                            const targetLat = 33.5666;
                            const targetLng = -117.6533;
                            
                            // Calculate distance (simplified)
                            const distance = Math.sqrt(
                                Math.pow(latitude - targetLat, 2) + 
                                Math.pow(longitude - targetLng, 2)
                            );
                            
                            // Allow within approximately 2 mile radius
                            const isInDeliveryZone = distance < 0.03;
                            
                            resolve({
                                latitude,
                                longitude,
                                isInDeliveryZone,
                                address: isInDeliveryZone ? 'Covenant Hills, Ladera Ranch, CA' : 'Outside delivery zone'
                            });
                        },
                        (error) => {
                            reject(error);
                        },
                        {
                            enableHighAccuracy: true,
                            timeout: 10000,
                            maximumAge: 300000
                        }
                    );
                });
            }
        };

        // Firebase Configuration Notice Component
        const FirebaseConfigNotice = () => {
            if (isFirebaseConfigured) return null;
            
            return (
                <div className="firebase-config-notice">
                    <h4><i className="fas fa-exclamation-triangle"></i> Firebase Configuration Required</h4>
                    <p>To use real authentication and database features, please:</p>
                    <ol style={{ marginTop: '10px', marginLeft: '20px' }}>
                        <li>Create a Firebase project at <a href="https://console.firebase.google.com" target="_blank">Firebase Console</a></li>
                        <li>Enable Authentication, Firestore, and Storage</li>
                        <li>Replace the <code>firebaseConfig</code> object in the code with your actual config</li>
                        <li>Set up Firestore security rules and enable Authentication providers</li>
                    </ol>
                    <p style={{ marginTop: '10px' }}><strong>Currently running in demo mode with mock data.</strong></p>
                </div>
            );
        };

        // Header Component
        const Header = ({ currentPage, setCurrentPage, user, onSignOut, cartItemCount }) => {
            return (
                <header className="header">
                    <nav className="nav">
                        <div className="logo">
                            <i className="fas fa-birthday-cake"></i>
                            Covenant Hills Bakery
                        </div>
                        <div className="nav-links">
                            <span 
                                className="nav-link" 
                                onClick={() => setCurrentPage('menu')}
                            >
                                Menu
                            </span>
                            {user ? (
                                <>
                                    <span 
                                        className="nav-link" 
                                        onClick={() => setCurrentPage('cart')}
                                    >
                                        Cart ({cartItemCount})
                                    </span>
                                    {(user.role === 'owner' || user.role === 'manager') && (
                                        <span 
                                            className="nav-link" 
                                            onClick={() => setCurrentPage('admin')}
                                        >
                                            Admin
                                        </span>
                                    )}
                                    <span className="nav-link">Hi, {user.displayName || user.name}!</span>
                                    <button className="btn btn-secondary" onClick={onSignOut}>
                                        Sign Out
                                    </button>
                                </>
                            ) : (
                                <button 
                                    className="btn btn-secondary" 
                                    onClick={() => setCurrentPage('auth')}
                                >
                                    Sign In
                                </button>
                            )}
                        </div>
                    </nav>
                </header>
            );
        };

        // Location Banner Component
        const LocationBanner = ({ locationStatus, locationData, user }) => {
            if (user && (user.role === 'owner' || user.role === 'manager')) {
                return (
                    <div className="admin-banner">
                        <i className="fas fa-crown"></i> Admin Mode: Location restrictions bypassed - you can order from anywhere
                    </div>
                );
            }
            
            if (locationStatus === 'loading') {
                return (
                    <div className="loading-banner">
                        <i className="fas fa-spinner fa-spin"></i> Checking your location...
                    </div>
                );
            }
            
            if (locationStatus === 'denied' || locationStatus === 'error') {
                return (
                    <div className="location-banner">
                        <i className="fas fa-exclamation-triangle"></i> 
                        Location access required. Please enable location services to place orders.
                    </div>
                );
            }
            
            if (locationStatus === 'outside-zone') {
                return (
                    <div className="location-banner">
                        <i className="fas fa-map-marker-alt"></i> 
                        Sorry, we only deliver to Covenant Hills, Ladera Ranch, CA. You appear to be outside our delivery zone.
                    </div>
                );
            }
            
            return null;
        };

        // Menu Component
        const Menu = ({ menuItems, onAddToCart, canOrder, loading }) => {
            if (loading) {
                return (
                    <div style={{ textAlign: 'center', padding: '40px' }}>
                        <i className="fas fa-spinner fa-spin" style={{ fontSize: '32px', color: '#667eea' }}></i>
                        <p style={{ marginTop: '20px' }}>Loading menu items...</p>
                    </div>
                );
            }

            return (
                <div>
                    <h2 style={{ textAlign: 'center', marginBottom: '30px', color: '#333' }}>
                        Our Delicious Menu
                    </h2>
                    <div className="menu-grid">
                        {menuItems.map(item => (
                            <div key={item.id} className="menu-item">
                                <div className="menu-item-image">
                                    {item.imageUrl ? (
                                        <img src={item.imageUrl} alt={item.name} />
                                    ) : (
                                        item.image
                                    )}
                                </div>
                                <div className="menu-item-content">
                                    <h3 className="menu-item-title">{item.name}</h3>
                                    <p className="menu-item-description">{item.description}</p>
                                    <div className="menu-item-price">${item.price.toFixed(2)}</div>
                                    {item.inStock ? (
                                        <button 
                                            className="btn btn-primary"
                                            onClick={() => onAddToCart(item)}
                                            disabled={!canOrder}
                                            style={{ 
                                                width: '100%',
                                                opacity: canOrder ? 1 : 0.5,
                                                cursor: canOrder ? 'pointer' : 'not-allowed'
                                            }}
                                        >
                                            <i className="fas fa-shopping-cart"></i> Add to Cart
                                        </button>
                                    ) : (
                                        <button className="btn" style={{ 
                                            width: '100%', 
                                            background: '#ccc', 
                                            color: '#666',
                                            cursor: 'not-allowed'
                                        }}>
                                            Out of Stock
                                        </button>
                                    )}
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // Cart Component
        const Cart = ({ cartItems, onUpdateQuantity, onRemoveItem, onCheckout }) => {
            const total = cartItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            if (cartItems.length === 0) {
                return (
                    <div className="card">
                        <h2>Your Cart</h2>
                        <p style={{ textAlign: 'center', color: '#666', margin: '40px 0' }}>
                            Your cart is empty. Continue shopping to add items!
                        </p>
                    </div>
                );
            }
            
            return (
                <div className="card">
                    <h2>Your Cart</h2>
                    <div style={{ marginTop: '20px' }}>
                        {cartItems.map(item => (
                            <div key={item.id} className="cart-item">
                                <div>
                                    <h4>{item.name}</h4>
                                    <p style={{ color: '#666' }}>${item.price.toFixed(2)} each</p>
                                </div>
                                <div style={{ display: 'flex', alignItems: 'center', gap: '15px' }}>
                                    <button 
                                        onClick={() => onUpdateQuantity(item.id, item.quantity - 1)}
                                        className="btn"
                                        style={{ padding: '5px 10px', minWidth: '35px' }}
                                    >
                                        -
                                    </button>
                                    <span style={{ minWidth: '20px', textAlign: 'center' }}>{item.quantity}</span>
                                    <button 
                                        onClick={() => onUpdateQuantity(item.id, item.quantity + 1)}
                                        className="btn"
                                        style={{ padding: '5px 10px', minWidth: '35px' }}
                                    >
                                        +
                                    </button>
                                    <button 
                                        onClick={() => onRemoveItem(item.id)}
                                        className="btn"
                                        style={{ padding: '5px 10px', background: '#ff6b6b', color: 'white' }}
                                    >
                                        <i className="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        ))}
                        <div style={{ 
                            marginTop: '20px', 
                            paddingTop: '20px', 
                            borderTop: '2px solid #eee',
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center'
                        }}>
                            <h3>Total: ${total.toFixed(2)}</h3>
                            <button className="btn btn-primary" onClick={onCheckout}>
                                <i className="fas fa-credit-card"></i> Proceed to Checkout
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // Checkout Component
        const Checkout = ({ cartItems, onOrderComplete, user }) => {
            const [deliveryAddress, setDeliveryAddress] = useState('');
            const [processing, setProcessing] = useState(false);
            
            const total = cartItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            const handleSubmitOrder = async (e) => {
                e.preventDefault();
                setProcessing(true);
                
                try {
                    // Simulate payment processing
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    
                    const order = {
                        userId: user.uid || user.id,
                        userEmail: user.email,
                        userName: user.displayName || user.name,
                        items: cartItems,
                        total,
                        deliveryAddress,
                        status: 'pending'
                    };
                    
                    if (isFirebaseConfigured) {
                        await FirebaseService.orders.addOrder(order);
                    }
                    
                    onOrderComplete({ ...order, id: Date.now(), createdAt: new Date().toISOString() });
                } catch (error) {
                    console.error('Order submission error:', error);
                    alert('Failed to submit order. Please try again.');
                } finally {
                    setProcessing(false);
                }
            };
            
            return (
                <div className="card">
                    <h2>Checkout</h2>
                    <form onSubmit={handleSubmitOrder}>
                        <div className="form-group">
                            <label className="form-label">Delivery Address</label>
                            <textarea
                                className="form-input"
                                value={deliveryAddress}
                                onChange={(e) => setDeliveryAddress(e.target.value)}
                                placeholder="Enter your full delivery address in Covenant Hills, Ladera Ranch, CA"
                                rows="3"
                                required
                            />
                        </div>
                        
                        <div style={{ marginBottom: '20px' }}>
                            <h3>Order Summary</h3>
                            {cartItems.map(item => (
                                <div key={item.id} style={{ 
                                    display: 'flex', 
                                    justifyContent: 'space-between',
                                    padding: '10px 0'
                                }}>
                                    <span>{item.name} x {item.quantity}</span>
                                    <span>${(item.price * item.quantity).toFixed(2)}</span>
                                </div>
                            ))}
                            <div style={{ 
                                borderTop: '1px solid #eee',
                                paddingTop: '10px',
                                marginTop: '10px',
                                fontWeight: 'bold'
                            }}>
                                Total: ${total.toFixed(2)}
                            </div>
                        </div>
                        
                        <button 
                            type="submit" 
                            className="btn btn-primary"
                            disabled={processing}
                            style={{ width: '100%' }}
                        >
                            {processing ? (
                                <>
                                    <i className="fas fa-spinner fa-spin"></i> Processing Order...
                                </>
                            ) : (
                                <>
                                    <i className="fas fa-credit-card"></i> Place Order
                                </>
                            )}
                        </button>
                    </form>
                </div>
            );
        };

        // Auth Component
        const Auth = ({ onLogin }) => {
            const [isSignUp, setIsSignUp] = useState(false);
            const [formData, setFormData] = useState({
                name: '',
                email: '',
                password: ''
            });
            const [loading, setLoading] = useState(false);
            
            const handleSubmit = async (e) => {
                e.preventDefault();
                setLoading(true);
                
                try {
                    if (isFirebaseConfigured) {
                        let firebaseUser;
                        if (isSignUp) {
                            firebaseUser = await FirebaseService.auth.signUp(
                                formData.email, 
                                formData.password, 
                                formData.name
                            );
                        } else {
                            firebaseUser = await FirebaseService.auth.signIn(
                                formData.email, 
                                formData.password
                            );
                        }
                        
                        // Get user data from Firestore
                        const userData = await FirebaseService.users.getUserData(firebaseUser.uid);
                        onLogin({ ...firebaseUser, ...userData });
                    } else {
                        // Mock authentication for demo
                        await new Promise(resolve => setTimeout(resolve, 1000));
                        
                        if (!isSignUp && formData.email === 'admin@bakery.com' && formData.password === 'admin123') {
                            const user = {
                                uid: '1',
                                email: formData.email,
                                displayName: 'Admin User',
                                role: 'owner'
                            };
                            onLogin(user);
                        } else {
                            const user = {
                                uid: Date.now().toString(),
                                email: formData.email,
                                displayName: formData.name || formData.email.split('@')[0],
                                role: 'customer'
                            };
                            onLogin(user);
                        }
                    }
                } catch (error) {
                    console.error('Authentication error:', error);
                    alert('Authentication failed: ' + error.message);
                } finally {
                    setLoading(false);
                }
            };
            
            const handleGoogleSignIn = async () => {
                setLoading(true);
                try {
                    if (isFirebaseConfigured) {
                        const firebaseUser = await FirebaseService.auth.signInWithGoogle();
                        const userData = await FirebaseService.users.getUserData(firebaseUser.uid);
                        onLogin({ ...firebaseUser, ...userData });
                    } else {
                        // Mock Google sign-in
                        await new Promise(resolve => setTimeout(resolve, 1000));
                        const user = {
                            uid: Date.now().toString(),
                            email: 'user@gmail.com',
                            displayName: 'Google User',
                            role: 'customer'
                        };
                        onLogin(user);
                    }
                } catch (error) {
                    console.error('Google sign-in error:', error);
                    alert('Google sign-in failed: ' + error.message);
                } finally {
                    setLoading(false);
                }
            };
            
            return (
                <div className="card" style={{ maxWidth: '400px', margin: '0 auto' }}>
                    <h2>{isSignUp ? 'Sign Up' : 'Sign In'}</h2>
                    
                    <button 
                        className="google-btn" 
                        onClick={handleGoogleSignIn} 
                        disabled={loading}
                    >
                        <i className="fab fa-google"></i>
                        Continue with Google
                    </button>
                    
                    <div className="divider">
                        <span>or</span>
                    </div>
                    
                    <form onSubmit={handleSubmit}>
                        {isSignUp && (
                            <div className="form-group">
                                <label className="form-label">Full Name</label>
                                <input
                                    type="text"
                                    className="form-input"
                                    value={formData.name}
                                    onChange={(e) => setFormData({...formData, name: e.target.value})}
                                    required
                                />
                            </div>
                        )}
                        
                        <div className="form-group">
                            <label className="form-label">Email</label>
                            <input
                                type="email"
                                className="form-input"
                                value={formData.email}
                                onChange={(e) => setFormData({...formData, email: e.target.value})}
                                required
                            />
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Password</label>
                            <input
                                type="password"
                                className="form-input"
                                value={formData.password}
                                onChange={(e) => setFormData({...formData, password: e.target.value})}
                                required
                                minLength={isFirebaseConfigured ? "6" : "1"}
                            />
                        </div>
                        
                        <button 
                            type="submit" 
                            className="btn btn-primary"
                            disabled={loading}
                            style={{ width: '100%', marginBottom: '15px' }}
                        >
                            {loading ? 'Please wait...' : (isSignUp ? 'Sign Up' : 'Sign In')}
                        </button>
                    </form>
                    
                    <p style={{ textAlign: 'center' }}>
                        {isSignUp ? 'Already have an account?' : "Don't have an account?"}{' '}
                        <span 
                            onClick={() => setIsSignUp(!isSignUp)}
                            style={{ color: '#667eea', cursor: 'pointer' }}
                        >
                            {isSignUp ? 'Sign In' : 'Sign Up'}
                        </span>
                    </p>
                    
                    {!isFirebaseConfigured && (
                        <div style={{ 
                            marginTop: '20px', 
                            padding: '15px', 
                            background: '#f8f9fa',
                            borderRadius: '8px',
                            fontSize: '14px'
                        }}>
                            <strong>Demo Credentials:</strong><br/>
                            Admin: admin@bakery.com / admin123<br/>
                            Customer: Any email/password combination
                        </div>
                    )}
                </div>
            );
        };

        // Admin Panel Component
        const AdminPanel = ({ orders, menuItems, onUpdateMenuItem, onAddMenuItem, loading }) => {
            const [newItem, setNewItem] = useState({
                name: '',
                description: '',
                price: '',
                category: 'cupcakes',
                image: 'ðŸ§'
            });
            const [uploading, setUploading] = useState(false);
            
            const handleAddItem = async (e) => {
                e.preventDefault();
                setUploading(true);
                
                try {
                    const item = {
                        name: newItem.name,
                        description: newItem.description,
                        price: parseFloat(newItem.price),
                        category: newItem.category,
                        image: newItem.image,
                        imageUrl: null, // No image upload for now
                        inStock: true
                    };
                    
                    if (isFirebaseConfigured) {
                        await FirebaseService.menu.addItem(item);
                    } else {
                        onAddMenuItem({ ...item, id: Date.now().toString() });
                    }
                    
                    setNewItem({
                        name: '',
                        description: '',
                        price: '',
                        category: 'cupcakes',
                        image: 'ðŸ§'
                    });
                } catch (error) {
                    console.error('Error adding item:', error);
                    alert('Failed to add item: ' + error.message);
                } finally {
                    setUploading(false);
                }
            };
            
            const toggleStock = async (itemId) => {
                const item = menuItems.find(item => item.id === itemId);
                const updatedItem = { ...item, inStock: !item.inStock };
                
                try {
                    if (isFirebaseConfigured) {
                        await FirebaseService.menu.updateItem(itemId, { inStock: !item.inStock });
                    } else {
                        onUpdateMenuItem(itemId, updatedItem);
                    }
                } catch (error) {
                    console.error('Error updating item:', error);
                    alert('Failed to update item: ' + error.message);
                }
            };
            
            if (loading) {
                return (
                    <div style={{ textAlign: 'center', padding: '40px' }}>
                        <i className="fas fa-spinner fa-spin" style={{ fontSize: '32px', color: '#667eea' }}></i>
                        <p style={{ marginTop: '20px' }}>Loading admin data...</p>
                    </div>
                );
            }
            
            return (
                <div className="admin-panel">
                    <h2 style={{ color: '#333', marginBottom: '30px' }}>Admin Dashboard</h2>
                    
                    <div className="admin-section">
                        <h3>Recent Orders</h3>
                        <div className="orders-list">
                            {orders.length === 0 ? (
                                <p style={{ color: '#666', textAlign: 'center' }}>No orders yet.</p>
                            ) : (
                                orders.slice(0, 10).map(order => (
                                    <div key={order.id} className="order-item">
                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
                                            <div>
                                                <h4>Order #{order.id}</h4>
                                                <p><strong>Customer:</strong> {order.userName || 'Unknown'}</p>
                                                <p><strong>Email:</strong> {order.userEmail || 'Unknown'}</p>
                                                <p><strong>Total:</strong> ${order.total.toFixed(2)}</p>
                                                <p><strong>Address:</strong> {order.deliveryAddress}</p>
                                                <p><strong>Items:</strong></p>
                                                <ul style={{ marginLeft: '20px' }}>
                                                    {order.items.map((item, index) => (
                                                        <li key={index}>
                                                            {item.name} x {item.quantity} - ${(item.price * item.quantity).toFixed(2)}
                                                        </li>
                                                    ))}
                                                </ul>
                                            </div>
                                            <span className={`status-badge status-${order.status}`}>
                                                {order.status}
                                            </span>
                                        </div>
                                        <p style={{ color: '#666', fontSize: '12px', marginTop: '10px' }}>
                                            {order.createdAt ? new Date(order.createdAt).toLocaleString() : 'Unknown date'}
                                        </p>
                                    </div>
                                ))
                            )}
                        </div>
                    </div>
                    
                    <div className="admin-section">
                        <h3>Menu Management</h3>
                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '30px' }}>
                            <div>
                                <h4>Current Menu Items</h4>
                                <div style={{ background: 'white', borderRadius: '10px', padding: '20px' }}>
                                    {menuItems.map(item => (
                                        <div key={item.id} style={{ 
                                            display: 'flex', 
                                            justifyContent: 'space-between', 
                                            alignItems: 'center',
                                            padding: '10px 0',
                                            borderBottom: '1px solid #eee'
                                        }}>
                                            <div>
                                                <strong>{item.name}</strong> - ${item.price.toFixed(2)}
                                                <br/>
                                                <small style={{ color: item.inStock ? '#28a745' : '#dc3545' }}>
                                                    {item.inStock ? 'In Stock' : 'Out of Stock'}
                                                </small>
                                            </div>
                                            <button 
                                                className="btn"
                                                onClick={() => toggleStock(item.id)}
                                                style={{ 
                                                    background: item.inStock ? '#dc3545' : '#28a745',
                                                    color: 'white',
                                                    padding: '5px 15px'
                                                }}
                                            >
                                                {item.inStock ? 'Mark Out of Stock' : 'Mark In Stock'}
                                            </button>
                                        </div>
                                    ))}
                                </div>
                            </div>
                            
                            <div>
                                <h4>Add New Item</h4>
                                <div style={{ background: 'white', borderRadius: '10px', padding: '20px' }}>
                                    <form onSubmit={handleAddItem}>
                                        <div className="form-group">
                                            <label className="form-label">Name</label>
                                            <input
                                                type="text"
                                                className="form-input"
                                                value={newItem.name}
                                                onChange={(e) => setNewItem({...newItem, name: e.target.value})}
                                                required
                                            />
                                        </div>
                                        
                                        <div className="form-group">
                                            <label className="form-label">Description</label>
                                            <textarea
                                                className="form-input"
                                                value={newItem.description}
                                                onChange={(e) => setNewItem({...newItem, description: e.target.value})}
                                                rows="3"
                                                required
                                            />
                                        </div>
                                        
                                        <div className="form-group">
                                            <label className="form-label">Price ($)</label>
                                            <input
                                                type="number"
                                                step="0.01"
                                                min="0"
                                                className="form-input"
                                                value={newItem.price}
                                                onChange={(e) => setNewItem({...newItem, price: e.target.value})}
                                                required
                                            />
                                        </div>
                                        
                                        <div className="form-group">
                                            <label className="form-label">Category</label>
                                            <select
                                                className="form-input"
                                                value={newItem.category}
                                                onChange={(e) => setNewItem({...newItem, category: e.target.value})}
                                            >
                                                <option value="cupcakes">Cupcakes</option>
                                                <option value="cakes">Cakes</option>
                                                <option value="tarts">Tarts</option>
                                                <option value="bread">Bread</option>
                                                <option value="muffins">Muffins</option>
                                                <option value="pies">Pies</option>
                                            </select>
                                        </div>
                                        
                                        <div className="form-group">
                                            <label className="form-label">Emoji Icon</label>
                                            <select
                                                className="form-input"
                                                value={newItem.image}
                                                onChange={(e) => setNewItem({...newItem, image: e.target.value})}
                                            >
                                                <option value="ðŸ§">ðŸ§ Cupcake</option>
                                                <option value="ðŸ°">ðŸ° Cake</option>
                                                <option value="ðŸ¥§">ðŸ¥§ Pie</option>
                                                <option value="ðŸž">ðŸž Bread</option>
                                                <option value="ðŸ¥–">ðŸ¥– Baguette</option>
                                                <option value="ðŸ¥">ðŸ¥ Croissant</option>
                                                <option value="ðŸª">ðŸª Cookie</option>
                                                <option value="ðŸ§‡">ðŸ§‡ Waffle</option>
                                            </select>
                                        </div>
                                        
                                        <button 
                                            type="submit" 
                                            className="btn btn-primary" 
                                            style={{ width: '100%' }}
                                            disabled={uploading}
                                        >
                                            {uploading ? (
                                                <>
                                                    <i className="fas fa-spinner fa-spin"></i> Adding Item...
                                                </>
                                            ) : (
                                                <>
                                                    <i className="fas fa-plus"></i> Add Item
                                                </>
                                            )}
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Order Success Component
        const OrderSuccess = ({ order, onContinueShopping }) => {
            return (
                <div className="card" style={{ textAlign: 'center', maxWidth: '600px', margin: '0 auto' }}>
                    <div style={{ fontSize: '64px', marginBottom: '20px' }}>ðŸŽ‰</div>
                    <h2 style={{ color: '#28a745', marginBottom: '20px' }}>Order Placed Successfully!</h2>
                    <p style={{ fontSize: '18px', marginBottom: '30px' }}>
                        Thank you for your order! We'll start preparing your delicious items right away.
                    </p>
                    
                    <div style={{ 
                        background: '#f8f9fa', 
                        padding: '20px', 
                        borderRadius: '10px',
                        marginBottom: '30px',
                        textAlign: 'left'
                    }}>
                        <h3>Order Details</h3>
                        <p><strong>Order ID:</strong> #{order.id}</p>
                        <p><strong>Total:</strong> ${order.total.toFixed(2)}</p>
                        <p><strong>Delivery Address:</strong> {order.deliveryAddress}</p>
                        <p><strong>Status:</strong> <span className="status-badge status-pending">Pending</span></p>
                        
                        <h4 style={{ marginTop: '15px' }}>Items:</h4>
                        <ul>
                            {order.items.map((item, index) => (
                                <li key={index}>
                                    {item.name} x {item.quantity} - ${(item.price * item.quantity).toFixed(2)}
                                </li>
                            ))}
                        </ul>
                    </div>
                    
                    <button className="btn btn-primary" onClick={onContinueShopping}>
                        <i className="fas fa-shopping-cart"></i> Continue Shopping
                    </button>
                </div>
            );
        };

        // Main App Component
        const App = () => {
            const [currentPage, setCurrentPage] = useState('menu');
            const [user, setUser] = useState(null);
            const [locationStatus, setLocationStatus] = useState('loading');
            const [locationData, setLocationData] = useState(null);
            const [menuItems, setMenuItems] = useState([]);
            const [cartItems, setCartItems] = useState([]);
            const [orders, setOrders] = useState([]);
            const [currentOrder, setCurrentOrder] = useState(null);
            const [loading, setLoading] = useState(true);
            const [menuLoading, setMenuLoading] = useState(true);
            const [ordersLoading, setOrdersLoading] = useState(true);

            // Firebase auth state listener
            useEffect(() => {
                if (isFirebaseConfigured) {
                    const unsubscribe = FirebaseService.auth.onAuthStateChanged(async (firebaseUser) => {
                        if (firebaseUser) {
                            try {
                                const userData = await FirebaseService.users.getUserData(firebaseUser.uid);
                                setUser({ ...firebaseUser, ...userData });
                            } catch (error) {
                                console.error('Error getting user data:', error);
                                setUser(firebaseUser);
                            }
                        } else {
                            setUser(null);
                        }
                        setLoading(false);
                    });
                    
                    return unsubscribe;
                } else {
                    // Demo mode - start with admin user
                    setUser({
                        uid: '1',
                        email: 'admin@bakery.com',
                        displayName: 'Admin User',
                        role: 'owner'
                    });
                    setLoading(false);
                }
            }, []);

            // Load menu items
            useEffect(() => {
                if (isFirebaseConfigured) {
                    const unsubscribe = FirebaseService.menu.getItems().onSnapshot((snapshot) => {
                        const items = snapshot.docs.map(doc => ({
                            id: doc.id,
                            ...doc.data()
                        }));
                        setMenuItems(items);
                        setMenuLoading(false);
                    }, (error) => {
                        console.error('Error loading menu items:', error);
                        setMenuItems(MOCK_MENU_ITEMS);
                        setMenuLoading(false);
                    });
                    
                    return unsubscribe;
                } else {
                    setMenuItems(MOCK_MENU_ITEMS);
                    setMenuLoading(false);
                }
            }, []);

            // Load orders for admin
            useEffect(() => {
                if (user && (user.role === 'owner' || user.role === 'manager')) {
                    if (isFirebaseConfigured) {
                        const unsubscribe = FirebaseService.orders.getOrders().onSnapshot((snapshot) => {
                            const ordersData = snapshot.docs.map(doc => ({
                                id: doc.id,
                                ...doc.data(),
                                createdAt: doc.data().createdAt?.toDate()?.toISOString()
                            }));
                            setOrders(ordersData);
                            setOrdersLoading(false);
                        }, (error) => {
                            console.error('Error loading orders:', error);
                            setOrdersLoading(false);
                        });
                        
                        return unsubscribe;
                    } else {
                        setOrdersLoading(false);
                    }
                }
            }, [user]);

            // Check location on component mount
            useEffect(() => {
                checkUserLocation();
            }, []);

            const checkUserLocation = async () => {
                setLocationStatus('loading');
                try {
                    const location = await LocationService.checkLocation();
                    setLocationData(location);
                    if (location.isInDeliveryZone) {
                        setLocationStatus('approved');
                    } else {
                        setLocationStatus('outside-zone');
                    }
                } catch (error) {
                    console.error('Location check failed:', error);
                    if (error.code === 1) {
                        setLocationStatus('denied');
                    } else {
                        setLocationStatus('error');
                    }
                }
            };

            const canOrder = (locationStatus === 'approved' || (user && (user.role === 'owner' || user.role === 'manager'))) && user;

            const handleLogin = (userData) => {
                setUser(userData);
                setCurrentPage('menu');
            };

            const handleSignOut = async () => {
                try {
                    if (isFirebaseConfigured) {
                        await FirebaseService.auth.signOut();
                    }
                } catch (error) {
                    console.error('Sign out error:', error);
                }
                setUser(null);
                setCartItems([]);
                setCurrentPage('menu');
            };

            const handleAddToCart = (item) => {
                if (!canOrder) return;
                
                setCartItems(prevItems => {
                    const existingItem = prevItems.find(cartItem => cartItem.id === item.id);
                    if (existingItem) {
                        return prevItems.map(cartItem =>
                            cartItem.id === item.id
                                ? { ...cartItem, quantity: cartItem.quantity + 1 }
                                : cartItem
                        );
                    } else {
                        return [...prevItems, { ...item, quantity: 1 }];
                    }
                });
            };

            const handleUpdateQuantity = (itemId, newQuantity) => {
                if (newQuantity <= 0) {
                    handleRemoveItem(itemId);
                    return;
                }
                
                setCartItems(prevItems =>
                    prevItems.map(item =>
                        item.id === itemId
                            ? { ...item, quantity: newQuantity }
                            : item
                    )
                );
            };

            const handleRemoveItem = (itemId) => {
                setCartItems(prevItems => prevItems.filter(item => item.id !== itemId));
            };

            const handleCheckout = () => {
                if (cartItems.length === 0) return;
                setCurrentPage('checkout');
            };

            const handleOrderComplete = (order) => {
                setOrders(prevOrders => [order, ...prevOrders]);
                setCurrentOrder(order);
                setCartItems([]);
                setCurrentPage('order-success');
            };

            const handleContinueShopping = () => {
                setCurrentOrder(null);
                setCurrentPage('menu');
            };

            const handleUpdateMenuItem = (itemId, updatedItem) => {
                setMenuItems(prevItems =>
                    prevItems.map(item =>
                        item.id === itemId ? updatedItem : item
                    )
                );
            };

            const handleAddMenuItem = (newItem) => {
                setMenuItems(prevItems => [newItem, ...prevItems]);
            };

            const cartItemCount = cartItems.reduce((sum, item) => sum + item.quantity, 0);

            if (loading) {
                return (
                    <div style={{ 
                        display: 'flex', 
                        justifyContent: 'center', 
                        alignItems: 'center', 
                        height: '100vh',
                        flexDirection: 'column'
                    }}>
                        <i className="fas fa-spinner fa-spin" style={{ fontSize: '48px', color: '#667eea' }}></i>
                        <p style={{ marginTop: '20px', fontSize: '18px' }}>Loading Covenant Hills Bakery...</p>
                    </div>
                );
            }

            return (
                <div>
                    <Header 
                        currentPage={currentPage}
                        setCurrentPage={setCurrentPage}
                        user={user}
                        onSignOut={handleSignOut}
                        cartItemCount={cartItemCount}
                    />
                    
                    <div className="container">
                        <FirebaseConfigNotice />
                        
                        <LocationBanner 
                            locationStatus={locationStatus}
                            locationData={locationData}
                            user={user}
                        />
                        
                        {locationStatus === 'loading' && !(user && (user.role === 'owner' || user.role === 'manager')) && (
                            <div style={{ textAlign: 'center', padding: '40px' }}>
                                <i className="fas fa-spinner fa-spin" style={{ fontSize: '32px', color: '#667eea' }}></i>
                            </div>
                        )}
                        
                        {(locationStatus !== 'loading' || (user && (user.role === 'owner' || user.role === 'manager'))) && (
                            <>
                                {currentPage === 'menu' && (
                                    <Menu 
                                        menuItems={menuItems}
                                        onAddToCart={handleAddToCart}
                                        canOrder={canOrder}
                                        loading={menuLoading}
                                    />
                                )}
                                
                                {currentPage === 'cart' && user && (
                                    <Cart 
                                        cartItems={cartItems}
                                        onUpdateQuantity={handleUpdateQuantity}
                                        onRemoveItem={handleRemoveItem}
                                        onCheckout={handleCheckout}
                                    />
                                )}
                                
                                {currentPage === 'checkout' && user && canOrder && (
                                    <Checkout 
                                        cartItems={cartItems}
                                        onOrderComplete={handleOrderComplete}
                                        user={user}
                                    />
                                )}
                                
                                {currentPage === 'auth' && (
                                    <Auth onLogin={handleLogin} />
                                )}
                                
                                {currentPage === 'admin' && user && (user.role === 'owner' || user.role === 'manager') && (
                                    <AdminPanel 
                                        orders={orders}
                                        menuItems={menuItems}
                                        onUpdateMenuItem={handleUpdateMenuItem}
                                        onAddMenuItem={handleAddMenuItem}
                                        loading={ordersLoading}
                                    />
                                )}
                                
                                {currentPage === 'order-success' && currentOrder && (
                                    <OrderSuccess 
                                        order={currentOrder}
                                        onContinueShopping={handleContinueShopping}
                                    />
                                )}
                                
                                {/* Redirect non-authenticated users trying to access protected pages */}
                                {!user && (currentPage === 'cart' || currentPage === 'checkout' || currentPage === 'admin') && (
                                    <div className="card" style={{ textAlign: 'center' }}>
                                        <h2>Sign In Required</h2>
                                        <p>Please sign in to access this page.</p>
                                        <button 
                                            className="btn btn-primary"
                                            onClick={() => setCurrentPage('auth')}
                                        >
                                            Sign In
                                        </button>
                                    </div>
                                )}
                                
                                {/* Redirect non-admin users trying to access admin */}
                                {user && currentPage === 'admin' && user.role !== 'owner' && user.role !== 'manager' && (
                                    <div className="card" style={{ textAlign: 'center' }}>
                                        <h2>Access Denied</h2>
                                        <p>You don't have permission to access the admin panel.</p>
                                        <button 
                                            className="btn btn-primary"
                                            onClick={() => setCurrentPage('menu')}
                                        >
                                            Back to Menu
                                        </button>
                                    </div>
                                )}
                            </>
                        )}
                        
                        {/* Location retry button - only show for non-admin users */}
                        {(locationStatus === 'denied' || locationStatus === 'error') && 
                         !(user && (user.role === 'owner' || user.role === 'manager')) && (
                            <div style={{ textAlign: 'center', marginTop: '20px' }}>
                                <button 
                                    className="btn btn-secondary"
                                    onClick={checkUserLocation}
                                >
                                    <i className="fas fa-redo"></i> Retry Location Check
                                </button>
                            </div>
                        )}
                    </div>
                    
                    {/* Footer */}
                    <footer style={{ 
                        marginTop: '60px', 
                        padding: '40px 20px', 
                        background: '#333', 
                        color: 'white',
                        textAlign: 'center'
                    }}>
                        <div style={{ maxWidth: '1200px', margin: '0 auto' }}>
                            <div style={{ marginBottom: '20px' }}>
                                <div className="logo" style={{ justifyContent: 'center', marginBottom: '15px' }}>
                                    <i className="fas fa-birthday-cake"></i>
                                    Covenant Hills Bakery
                                </div>
                                <p>Serving fresh, delicious baked goods to Covenant Hills, Ladera Ranch, CA</p>
                            </div>
                            
                            <div style={{ 
                                display: 'grid', 
                                gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                                gap: '30px',
                                marginBottom: '30px'
                            }}>
                                <div>
                                    <h4 style={{ marginBottom: '15px' }}>Contact</h4>
                                    <p><i className="fas fa-phone"></i> (949) 123-4567</p>
                                    <p><i className="fas fa-envelope"></i> info@covenanthillsbakery.com</p>
                                    <p><i className="fas fa-map-marker-alt"></i> Covenant Hills, Ladera Ranch, CA</p>
                                </div>
                                
                                <div>
                                    <h4 style={{ marginBottom: '15px' }}>Hours</h4>
                                    <p>Monday - Friday: 7:00 AM - 7:00 PM</p>
                                    <p>Saturday: 8:00 AM - 8:00 PM</p>
                                    <p>Sunday: 9:00 AM - 6:00 PM</p>
                                </div>
                                
                                <div>
                                    <h4 style={{ marginBottom: '15px' }}>Follow Us</h4>
                                    <div style={{ display: 'flex', gap: '15px', justifyContent: 'center' }}>
                                        <i className="fab fa-facebook" style={{ fontSize: '24px', cursor: 'pointer' }}></i>
                                        <i className="fab fa-instagram" style={{ fontSize: '24px', cursor: 'pointer' }}></i>
                                        <i className="fab fa-twitter" style={{ fontSize: '24px', cursor: 'pointer' }}></i>
                                    </div>
                                </div>
                            </div>
                            
                            <div style={{ 
                                borderTop: '1px solid #555', 
                                paddingTop: '20px',
                                fontSize: '14px',
                                color: '#ccc'
                            }}>
                                <p>&copy; 2025 Covenant Hills Bakery. All rights reserved.</p>
                                <p style={{ marginTop: '10px' }}>
                                    <strong>
                                        {isFirebaseConfigured ? 'Firebase Integration Active' : 'Demo Mode'} 
                                    </strong> - 
                                    {isFirebaseConfigured 
                                        ? ' Real-time database, authentication, and file storage enabled!'
                                        : ' Replace Firebase config to enable real backend functionality!'
                                    }
                                </p>
                            </div>
                        </div>
                    </footer>
                </div>
            );
        };

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>